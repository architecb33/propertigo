{"version":3,"sources":["../../src/pages/login-modal/login-modal.module.ts","../../src/pages/login-modal/login-modal.ts"],"names":[],"mappings":"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","file":"7.main.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { LoginModal } from './login-modal';\n\n@NgModule({\n  declarations: [\n    LoginModal,\n  ],\n  imports: [\n    IonicPageModule.forChild(LoginModal),\n    TranslateModule.forChild()\n  ],\n  exports: [\n    LoginModal\n  ]\n})\nexport class LoginModalModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login-modal/login-modal.module.ts","import { Component } from '@angular/core';\nimport { Events, ViewController, ToastController, LoadingController, IonicPage } from 'ionic-angular';\nimport {WPlogin} from '../../providers/wplogin/wplogin';\nimport { Storage } from '@ionic/storage';\nimport {Device} from '@ionic-native/device';\nimport {TranslateService} from '@ngx-translate/core';\n\n@IonicPage()\n@Component({\n  selector: 'page-login-modal',\n  templateUrl: 'login-modal.html'\n})\nexport class LoginModal {\n\n\tlogin:any = {}\n\tlogin_data: any\n\tspinner: any\n\n\tconstructor(\n\t\tpublic viewCtrl: ViewController,\n\t\tpublic loadingCtrl: LoadingController,\n\t\tpublic wplogin: WPlogin,\n\t\tpublic events: Events,\n\t\tpublic storage: Storage,\n\t\tpublic translate: TranslateService,\n\t\tprivate Device: Device\n\t\t) {\n\n\t\t// login through postmessage sets login_data this way\n\t\tevents.subscribe('modal:logindata', data => {\n\t      this.setLoginData(data);\n\t    });\n\n\t\t// get login data on first load\n\t\tthis.storage.get('user_login').then( data => {\n\n\t\t\tif(data) {\n\t\t\t  this.login_data = data\n\t\t\t}\n\n\t\t});\n\n\t}\n\n\tdoLogin() {\n\n\t\t// if in preview, Device.platform is empty object. On device it should be string like 'iOS'\n\t\tif( typeof this.Device.platform != 'string' ) {\n\n\t\t\tthis.translate.get('Please try from a device.').subscribe( text => {\n\t\t\t\talert(text);\n\t\t\t})\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis.translate.get('Please enter a valid login.').subscribe( text => {\n\t\t\tif( !this.login )\n\t\t\t\talert(text)\n\t\t})\n\n\t\tthis.showSpinner()\n\n\t\tthis.wplogin.login( this.login ).then( response => {\n\n\t\t\tif( (<any>response).success === false ) {\n\t\t\t\tthis.loginErr( response )\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.storage.set( 'user_login', (<any>response).data )\n\t\t\tthis.events.publish('user:login', (<any>response).data )\n\t\t\tthis.login_data = (<any>response).data\n\t\t\tthis.dismiss()\n\n\t\t\tthis.hideSpinner()\n\n\t\t}, (err) => {\n\n\t\t\tthis.loginErr(err)\n\n\t\t}).catch( e => {\n\t\t\tconsole.warn(e)\n\t\t\tthis.hideSpinner()\n\t\t\tthis.translate.get('There was a problem connecting to the server.').subscribe( text => {\n\t\t\t\talert(text);\n\t\t\t});\n\t\t})\n\t}\n\n\tloginErr( err ) {\n\n\t\tconsole.log(err)\n\n\t\tthis.hideSpinner()\n\n\t\tthis.translate.get('There was a problem, please try again.').subscribe( text => {\n\t\t\tlet msg = text;\n\n\t\t\tif( err.data && err.data.message )\n\t\t\t\tmsg += ' ' + err.data.message\n\n\t\t\talert( msg )\n\t\t});\n\n\t}\n\n\tdoLogout() {\n\n\t\tthis.showSpinner()\n\n\t\tthis.wplogin.logout().then( response => {\n\n\t\t\tthis.storage.remove( 'user_login' )\n\t\t\tthis.events.publish('user:logout' )\n\t\t\tthis.login_data = null\n\t\t\tthis.dismiss()\n\t\t\tthis.hideSpinner()\n\n\t\t}, (err) => {\n\n\t\t\tthis.storage.remove( 'user_login' )\n\t\t\tthis.events.publish('user:logout' )\n\t\t\tthis.login_data = null\n\t\t\tthis.hideSpinner()\n\n\t\t\tconsole.log(err)\n\n\t\t\tthis.translate.get('You are logged out of the app, but there was a problem on the server.').subscribe( text => {\n\t\t\t\tlet msg = text;\n\n\t\t\t\tif( err.data && err.data.message )\n\t\t\t\t\tmsg += ' ' + err.data.message\n\n\t\t\t\talert( msg )\n\t\t\t})\n\t\t}).catch( e => {\n\t\t\tconsole.warn(e)\n\t\t\tthis.hideSpinner()\n\t\t\tthis.translate.get('There was a problem connecting to the server.').subscribe( text => {\n\t\t\t\talert(text)\n\t\t\t})\n\t\t})\n\n\t}\n\n\tsetLoginData( data ) {\n\t\tthis.login_data = data\n\t\tconsole.log('setLoginData', this.login_data)\n\t}\n\n\tdismiss() {\n\t\tthis.viewCtrl.dismiss();\n\t}\n\n\tshowSpinner() {\n\t\tthis.spinner = this.loadingCtrl.create();\n\n\t\tthis.spinner.present();\n\t}\n\n\thideSpinner() {\n\t\tthis.spinner.dismiss();\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login-modal/login-modal.ts"],"sourceRoot":""}